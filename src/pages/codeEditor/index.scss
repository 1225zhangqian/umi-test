$prefix: wd-;
$w-textarea: #{$prefix}code-editor;

@media (prefers-color-scheme: dark) {
  .#{$w-textarea} {
    --wd-code-editor-fg-default: #c9d1d9;
    --wd-code-editor-canvas-subtle: #161b22;
    --wd-code-editor-prettylights-syntax-comment: #8b949e;
    --wd-code-editor-prettylights-syntax-entity-tag: #7ee787;
    --wd-code-editor-prettylights-syntax-entity: #d2a8ff;
    --wd-code-editor-prettylights-syntax-sublimelinter-gutter-mark: #484f58;
    --wd-code-editor-prettylights-syntax-constant: #79c0ff;
    --wd-code-editor-prettylights-syntax-string: #a5d6ff;
    --wd-code-editor-prettylights-syntax-keyword: #ff7b72;
    --wd-code-editor-prettylights-syntax-markup-bold: #c9d1d9;
  }
}

@media (prefers-color-scheme: light) {
  .#{$w-textarea} {
    --wd-code-editor-fg-default: #24292f;
    --wd-code-editor-canvas-subtle: #f6f8fa;
    --wd-code-editor-prettylights-syntax-comment: #6e7781;
    --wd-code-editor-prettylights-syntax-entity-tag: #116329;
    --wd-code-editor-prettylights-syntax-entity: #8250df;
    --wd-code-editor-prettylights-syntax-sublimelinter-gutter-mark: #8c959f;
    --wd-code-editor-prettylights-syntax-constant: #0550ae;
    --wd-code-editor-prettylights-syntax-string: #0a3069;
    --wd-code-editor-prettylights-syntax-keyword: #cf222e;
    --wd-code-editor-prettylights-syntax-markup-bold: #24292f;
  }
}

.#{$w-textarea}[data-color-mode*='dark'] {
  --wd-code-editor-fg-default: #c9d1d9;
  --wd-code-editor-canvas-subtle: #161b22;
  --wd-code-editor-prettylights-syntax-comment: #8b949e;
  --wd-code-editor-prettylights-syntax-entity-tag: #7ee787;
  --wd-code-editor-prettylights-syntax-entity: #d2a8ff;
  --wd-code-editor-prettylights-syntax-sublimelinter-gutter-mark: #484f58;
  --wd-code-editor-prettylights-syntax-constant: #79c0ff;
  --wd-code-editor-prettylights-syntax-string: #a5d6ff;
  --wd-code-editor-prettylights-syntax-keyword: #ff7b72;
  --wd-code-editor-prettylights-syntax-markup-bold: #c9d1d9;
}

.#{$w-textarea}[data-color-mode*='light'] {
  --wd-code-editor-fg-default: #24292f;
  --wd-code-editor-canvas-subtle: #f6f8fa;
  --wd-code-editor-prettylights-syntax-comment: #6e7781;
  --wd-code-editor-prettylights-syntax-entity-tag: #116329;
  --wd-code-editor-prettylights-syntax-entity: #8250df;
  --wd-code-editor-prettylights-syntax-sublimelinter-gutter-mark: #8c959f;
  --wd-code-editor-prettylights-syntax-constant: #0550ae;
  --wd-code-editor-prettylights-syntax-string: #0a3069;
  --wd-code-editor-prettylights-syntax-keyword: #cf222e;
  --wd-code-editor-prettylights-syntax-markup-bold: #24292f;
}

.#{$prefix}code-editor-root {
  .#{$prefix}form-input-wrap.is-focused:not(.is-disabled),
  .#{$prefix}form-input-wrap:focus:not(.is-disabled),
  .#{$prefix}form-input-wrap:hover:not(.is-disabled) {
    background-color: var(--wd-code-editor-canvas-subtle);
    color: var(--wd-code-editor-fg-default);
  }
  .#{$prefix}form-input-wrap {
    display: block;
    height: 100%;
    overflow: auto;
  }
}
.#{$prefix}code-editor {
  padding: 0;
  min-height: 200px;
  min-width: 200px;
  overflow: auto;
  font-family: inherit;
  font-size: 12px;
  background-color: var(--wd-code-editor-canvas-subtle);
  color: var(--wd-code-editor-fg-default);
  &__content {
    position: relative;
    overflow: hidden;
    width: 100%;
    &-preview {
      padding: 5px 16px 5px 0;
      min-height: 60px;
      height: 100%;
      width: 100%;
      white-space: pre-wrap;
      word-break: keep-all;
      overflow-wrap: break-word;
      margin: 0px;
      border: 0px;
      box-sizing: inherit;
      display: inherit;
      font-family: inherit;
      font-size: inherit;
      font-style: inherit;
      font-variant-ligatures: inherit;
      font-weight: inherit;
      letter-spacing: inherit;
      line-height: inherit;
      tab-size: inherit;
      text-indent: inherit;
      text-rendering: inherit;
      text-transform: inherit;
      overflow: hidden;
    }

    &-preview {
      pre {
        overflow: hidden;
        margin: 0;
        padding: 0;
        white-space: inherit;
        font-family: inherit;
        font-size: inherit;
        code {
          font-family: inherit;
        }
      }
    }
    > textarea {
      padding: 5px 16px 5px 60px;
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0.8;
      color: transparent;
      height: 100%;
      width: 100%;
      resize: none;
      white-space: pre-wrap;
      word-break: keep-all;
      overflow-wrap: break-word;
      margin: 0px;
      border: 0px;
      background: none;
      box-sizing: inherit;
      display: inherit;
      font-family: inherit;
      font-size: inherit;
      font-style: inherit;
      font-variant-ligatures: inherit;
      font-weight: inherit;
      letter-spacing: inherit;
      line-height: inherit;
      tab-size: inherit;
      text-indent: inherit;
      text-rendering: inherit;
      text-transform: inherit;
      outline: 0px;
      overflow: hidden;
    }
  }

  code[class*='language-'],
  pre[class*='language-'] {
    .token.cdata,
    .token.comment,
    .token.doctype,
    .token.prolog {
      color: var(--wd-code-editor-prettylights-syntax-comment);
    }
    .token.punctuation {
      color: var(
        --wd-code-editor-prettylights-syntax-sublimelinter-gutter-mark
      );
    }
    .namespace {
      opacity: 0.7;
    }

    .token.boolean,
    .token.constant,
    .token.deleted,
    .token.number,
    .token.symbol {
      color: var(--wd-code-editor-prettylights-syntax-entity-tag);
    }

    .token.builtin,
    .token.char,
    .token.inserted,
    .token.selector,
    .token.string {
      color: var(--wd-code-editor-prettylights-syntax-constant);
    }

    .style .token.string,
    .token.entity,
    .token.property,
    .token.operator,
    .token.url {
      color: var(--wd-code-editor-prettylights-syntax-constant);
    }

    .token.atrule,
    .token.property-access .token.method,
    .token.keyword {
      color: var(--wd-code-editor-prettylights-syntax-keyword);
    }

    .token.function {
      color: var(--wd-code-editor-prettylights-syntax-string);
    }

    .token.important,
    .token.regex,
    .token.variable {
      color: var(--wd-code-editor-prettylights-syntax-string-regexp);
    }

    .token.bold,
    .token.important {
      color: var(--wd-code-editor-prettylights-syntax-markup-bold);
    }
    .token.tag {
      color: var(--wd-code-editor-prettylights-syntax-entity-tag);
    }
    .token.attr-value,
    .token.attr-name {
      color: var(--wd-code-editor-prettylights-syntax-constant);
    }
    .token.selector .class,
    .token.class-name {
      color: var(--wd-code-editor-prettylights-syntax-entity);
    }
  }

  .code-line {
    position: relative;
    display: block;
    margin-left: 60px;
    // padding-left: 16px;
    // padding-right: 16px;
    // margin-left: -16px;
    // margin-right: -16px;
    // border-left: 4px solid rgba(0, 0, 0, 0); /* Set placeholder for highlight accent border color to transparent */
  }

  .code-line.inserted {
    background-color: rgba(16, 185, 129, 0.2); /* Set inserted line (+) color */
  }

  .code-line.deleted {
    background-color: rgba(239, 68, 68, 0.2); /* Set deleted line (-) color */
  }

  .highlight-line {
    margin-left: -16px;
    margin-right: -16px;
    background-color: rgba(55, 65, 81, 0.5); /* Set highlight bg color */
    border-left: 4px solid rgb(59, 130, 246); /* Set highlight accent border color */
  }

  .highlight-line {
    // margin-left: -16px;
    // margin-right: -16px;
    background-color: rgba(55, 65, 81, 0.5); /* Set highlight bg color */
    border-left: 4px solid rgb(59, 130, 246); /* Set highlight accent border color */
  }
  .line-number::before {
    position: absolute;
    left: -60px;
    padding-right: 20px;
    display: inline-block;
    width: 40px;
    text-align: right;
    color: rgb(156, 163, 175); /* Line number color */
    content: attr(line);
  }
}
